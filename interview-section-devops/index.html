<!doctype html><html lang=en-us>
<head><meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="WIP
"><title>Вопросы и ответы для собеседования по теме "DevOps и деплой"</title>
<link rel=canonical href=https://blog.hook.sh/interview-section-devops/>
<link rel=stylesheet href=https://blog.hook.sh/scss/style.min.2505968f44d2e3e27dc3b1cecad9c2bcba873012fafced7bdfa0bccfbd890b11.css>
<meta property="og:title" content="Вопросы и ответы для собеседования по теме &#34;DevOps и деплой&#34;">
<meta property="og:description" content="WIP
">
<meta property="og:url" content="https://blog.hook.sh/interview-section-devops/">
<meta property="og:site_name" content="blog [dot] hook">
<meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="interview"><meta property="article:tag" content="network"><meta property="article:published_time" content="2022-02-17T11:13:55+00:00"><meta property="article:modified_time" content="2022-02-17T11:13:55+00:00"><meta property="og:image" content="https://blog.hook.sh/interview-section-devops/cover.png">
<meta name=twitter:title content="Вопросы и ответы для собеседования по теме &#34;DevOps и деплой&#34;">
<meta name=twitter:description content="WIP
"><meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://blog.hook.sh/interview-section-devops/cover.png">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-1B4Z5Q844N"></script>
<script>var dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-1B4Z5Q844N',{anonymize_ip:!0})}</script>
<link rel=apple-touch-icon sizes=180x180 href="https://blog.hook.sh/apple-touch-icon.png?v=1645110708">
<link rel=icon type=image/png sizes=32x32 href="https://blog.hook.sh/favicon-32x32.png?v=1645110708">
<link rel=icon type=image/png sizes=16x16 href="https://blog.hook.sh/favicon-16x16.png?v=1645110708">
<link rel=manifest href=https://blog.hook.sh/webmanifest.json>
<meta name=msapplication-TileColor content="#303030">
<meta name=theme-color content="#303030">
</head>
<body class="article-page has-toc">
<script>(function(){const a='StackColorScheme';localStorage.getItem(a)||localStorage.setItem(a,"dark")})()</script><script>(function(){const b='StackColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='auto'&&c?document.documentElement.dataset.scheme='dark':document.documentElement.dataset.scheme='light'})()</script>
<div class="container main-container flex
extended">
<div id=article-toolbar>
<a href=https://blog.hook.sh/ class=back-home><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18"/></svg>
<span>Назад</span>
</a>
</div>
<main class="main full-width">
<article class="has-image main-article">
<header class=article-header>
<div class=article-image>
<a href=/interview-section-devops/>
<img src=/interview-section-devops/cover_hu6c67f7c53f5822e46a26ba646cdfa3d5_55373_800x0_resize_box_3.png srcset="/interview-section-devops/cover_hu6c67f7c53f5822e46a26ba646cdfa3d5_55373_800x0_resize_box_3.png 800w, /interview-section-devops/cover_hu6c67f7c53f5822e46a26ba646cdfa3d5_55373_1600x0_resize_box_3.png 1600w" width=800 height=480 loading=lazy alt='Featured image of post Вопросы и ответы для собеседования по теме "DevOps и деплой"'>
</a>
</div>
<div class=article-details>
<header class=article-category>
<a href=/categories/dev/ style=background-color:#0d63ad;color:#fff>
Development
</a>
</header>
<h2 class=article-title>
<a href=/interview-section-devops/>Вопросы и ответы для собеседования по теме "DevOps и деплой"</a></h2>
<footer class=article-time>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>2022.02.17</time>
</div>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>
Время чтения: 3 мин.
</time>
</div>
</footer>
</div>
</header>
<section class=article-content>
<div class=outdated-post style=display:none data-posted-at=2022-02-17>
<strong>Внимание!</strong> Данный пост был опубликован более года назад и, возможно, уже утратил свою былую актуальность. Но это не точно.
</div>
<p><em>WIP</em></p>
<div class=toc>
<nav id=TableOfContents>
<ol>
<li><a href=#что-такое-bluegreen-deployment>Что такое Blue/Green deployment?</a></li>
<li><a href=#что-такое-canary-deployment>Что такое Canary deployment?</a></li>
<li><a href=#что-такое-dark-скрытые-или-ав-развертывания>Что такое Dark (скрытые) или А/В-развертывания?</a></li>
<li><a href=#какие-devops-тулзы-можно-использовать-для-кейса>Какие Devops тулзы можно использовать для кейса?</a></li>
<li><a href=#как-бы-был-устроен-деплой-для-этого-кейса>Как бы был устроен деплой для этого кейса?</a></li>
</ol>
</nav>
</div>
<h2 id=что-такое-bluegreen-deployment>Что такое Blue/Green deployment?</h2>
<p>Стратегия Blue/Green развертывания <em>(иногда ее ещё называют red/black)</em> предусматривает одновременное развертывание старой (зеленой) и новой (синей) версий приложения.</p>
<p>После размещения обеих версий обычные пользователи получают доступ к зеленой, в то время как синяя доступна для QA-команды для автоматизации тестов через отдельный сервис или прямой проброс портов. После того как синяя (новая) версия была протестирована и был одобрен ее релиз, сервис переключается на неё, а зеленая (старая) сворачивается.</p>
<p>На практике это означает то, что в одну единицу времени существует <strong>два production окружения</strong>. Один (первый) их них обрабатывает запросы в данный момент, второй - условно простаивает. В момент деплоя обновляется ПО на втором окружении, проверяется корректность его работы, и трафик единомоменто (с помощью впереди стоящего роутера) переключается с первого на второй. Первый таким образом освобождается для следующего обновления (но стоит заметить, что сразу его &ldquo;гасить&rdquo; часто нельзя, так как могут существовать транзакции, которые будут требовать своего завершения).</p>
<p>Из преимуществ такого подхода при деплое - это возможность быстрого отката до предыдущего состояния, и наличие &ldquo;горячего&rdquo; резерва.</p>
<p>С <strong>базами данных</strong> при таком подходе часто бывают проблемы, особенно если нужно менять их логические структуры для поддержки новой версии софта. Хитрость тут в том, чтобы разделить деплой изменения логических структур и обновление приложения. Для этого:</p>
<ul>
<li>Сначала нужно применить рефакторинг базы данных, чтобы изменить структуры для поддержки <strong>новой и старой</strong> версий приложения</li>
<li>Задеплоить эти изменения, проверить, что всё хорошо работает, и у нас есть версия предыдущего состояния</li>
<li>Только после этого задеплоить новую версию приложения</li>
<li>Когда обновления уже устаканились, удалить поддержку базы данных для старой версии</li>
</ul>
<blockquote>
<p>Что можно почитать:</p>
<ul>
<li><a class=link href=https://habr.com/ru/post/309832/ target=_blank rel=noopener>Сине-зеленый деплой</a></li>
</ul>
</blockquote>
<h2 id=что-такое-canary-deployment>Что такое Canary deployment?</h2>
<blockquote>
<p>Золотоискатели и шахтеры брали канареек (птички такие) на добычу - пока канарейки поют, можно работать, если замолчали - в шахте газ и пора уходить. Шахтеры жертвовали маленькой птичкой, чтобы выбираться из шахт живыми.</p>
</blockquote>
<p>Канареечные деплои похожи на сине-зеленые (Blue/Green), но лучше управляются и используют прогрессивный поэтапный подход. К этому типу относятся несколько различных стратегий, включая &ldquo;скрытые&rdquo; запуски и А/В-тестирование.</p>
<p>Эта стратегия применяется, когда необходимо испытать некую новую функциональность, как правило, в бэкенде приложения. Суть подхода в том, чтобы создать два практически одинаковых сервера - один обслуживает почти всех пользователей, а другой, с новыми функциями, обслуживает лишь небольшую подгруппу пользователей, после чего результаты их работы сравниваются.
Если все проходит без ошибок (канарейка выживает), новая версия постепенно выкатывается на всю инфраструктуру (или весь трафик переключается на новую версию).</p>
<div class=video-wrapper>
<iframe loading=lazy src=https://www.youtube.com/embed/GWH13lIvy0U allowfullscreen title="YouTube Video"></iframe>
</div>
<h2 id=что-такое-dark-скрытые-или-ав-развертывания>Что такое Dark (скрытые) или А/В-развертывания?</h2>
<p>Скрытое развертывание — еще одна вариация канареечной стратегии. Разница между скрытым и канареечным развертыванием состоит в том, что скрытые развертывания имеют дело с фронтендом, а не с бэкендом, как канареечные.</p>
<p>Другое название этих развертываний — А/В-тестирование. Вместо того чтобы открыть доступ к новой функции всем пользователям, ее предлагают лишь ограниченной их части. Обычно эти пользователи не знают, что выступают тестерами-первопроходцами (отсюда и термин &ldquo;скрытое развертывание&rdquo;).</p>
<p>С помощью переключателей функциональности (<code>feature toggles</code>) и других инструментов можно следить за тем, как пользователи взаимодействуют с новой функцией, увлекает ли она их или они считают новый пользовательский интерфейс запутанным, и другими типами метрик.</p>
<h2 id=какие-devops-тулзы-можно-использовать-для-кейса>Какие Devops тулзы можно использовать для кейса?</h2>
<p><em>WIP</em></p>
<h2 id=как-бы-был-устроен-деплой-для-этого-кейса>Как бы был устроен деплой для этого кейса?</h2>
<p><em>WIP</em></p>
</section>
<footer class=article-footer>
<section class=article-tags>
<a href=/tags/interview/>interview</a>
<a href=/tags/network/>network</a>
</section>
<div style=display:flex;justify-content:space-between;margin-top:1em>
<div>
<section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>WTFPL</span>
</section>
</div>
<div style=margin-left:auto><section style=height:100%>
<a href=https://github.com/hook-sh/blog/edit/master/content/post/interview-section-devops/index.md style=font-size:.7em;color:var(--card-text-color-tertiary)>Редиктировать</a>
</section>
</div>
</div></footer>
</article>
<aside class=related-contents--wrapper>
<h2 class=section-title>Может быть интересно</h2>
<div class=related-contents>
<div class="flex article-list--tile">
<article class=has-image>
<a href=/interview-section-network/>
<div class=article-image>
<img src=/interview-section-network/cover.b08b171fcdfc890295d4b669ae0c0bf3_huc9d9f0a86f4bd95be43803f8c116abdd_120539_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy data-key=interview-section-network data-hash="md5-sIsXH838iQKV1LZprgwL8w==">
</div>
<div class=article-details>
<h2 class=article-title>Вопросы и ответы для собеседования - сети</h2>
</div>
</a>
</article>
<article class=has-image>
<a href=/disable-cacheing-requirejs-files-while-develop/>
<div class=article-image>
<img src=/disable-cacheing-requirejs-files-while-develop/cover.013f076a0bfb446729b579401ac9a991_hu30c3e7f4088a0dadce48d1d04a5455c7_31682_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy data-key=disable-cacheing-requirejs-files-while-develop data-hash="md5-AT8Hagv7RGcptXlAGsmpkQ==">
</div>
<div class=article-details>
<h2 class=article-title>Отключаем кэширование загружаемых RequireJS файлов при разработке</h2>
</div>
</a>
</article>
<article class=has-image>
<a href=/requirejs-singletone/>
<div class=article-image>
<img src=/requirejs-singletone/cover.013f076a0bfb446729b579401ac9a991_hu30c3e7f4088a0dadce48d1d04a5455c7_31682_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy data-key=requirejs-singletone data-hash="md5-AT8Hagv7RGcptXlAGsmpkQ==">
</div>
<div class=article-details>
<h2 class=article-title>Синглтон для RequireJS</h2>
</div>
</a>
</article>
</div>
</div>
</aside>
<script src=https://utteranc.es/client.js repo=hook-sh/blog issue-term=pathname crossorigin=anonymous async></script>
<style>.utterances{max-width:unset}</style>
<script>function setUtterancesTheme(b){let a=document.querySelector('.utterances iframe');a&&a.contentWindow.postMessage({type:'set-theme',theme:`github-${b}`},'https://utteranc.es')}addEventListener('message',a=>{if(a.origin!=='https://utteranc.es')return;setUtterancesTheme(document.documentElement.dataset.scheme)}),window.addEventListener('onColorSchemeChange',a=>{setUtterancesTheme(a.detail)})</script>
<footer class=site-footer>
<section class=copyright>
&copy;
2014 -
2022 blog [dot] hook
</section>
<section class=powerby>
Make love, not war <br>
</section>
</footer>
<div class=pswp tabindex=-1 role=dialog aria-hidden=true>
<div class=pswp__bg></div>
<div class=pswp__scroll-wrap>
<div class=pswp__container>
<div class=pswp__item></div>
<div class=pswp__item></div>
<div class=pswp__item></div>
</div>
<div class="pswp__ui pswp__ui--hidden">
<div class=pswp__top-bar>
<div class=pswp__counter></div>
<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
<div class=pswp__preloader>
<div class=pswp__preloader__icn>
<div class=pswp__preloader__cut>
<div class=pswp__preloader__donut></div>
</div>
</div>
</div>
</div>
<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
<div class=pswp__share-tooltip></div>
</div>
<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
</button>
<div class=pswp__caption>
<div class=pswp__caption__center></div>
</div>
</div>
</div>
</div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous>
</main>
<aside class="sidebar right-sidebar sticky">
<section class="widget archives">
<div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
</div>
<h2 class="widget-title section-title">Содержание</h2>
<div class=widget--toc>
<nav id=TableOfContents>
<ol>
<li><a href=#что-такое-bluegreen-deployment>Что такое Blue/Green deployment?</a></li>
<li><a href=#что-такое-canary-deployment>Что такое Canary deployment?</a></li>
<li><a href=#что-такое-dark-скрытые-или-ав-развертывания>Что такое Dark (скрытые) или А/В-развертывания?</a></li>
<li><a href=#какие-devops-тулзы-можно-использовать-для-кейса>Какие Devops тулзы можно использовать для кейса?</a></li>
<li><a href=#как-бы-был-устроен-деплой-для-этого-кейса>Как бы был устроен деплой для этого кейса?</a></li>
</ol>
</nav>
</div>
</section>
</aside>
</div>
<script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous defer></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const a=document.createElement('link');a.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",a.type="text/css",a.rel="stylesheet",document.head.appendChild(a)})()</script>
<script data-no-instant>(function(){const a=document.querySelectorAll('.outdated-post'),b=new Date;for(let c=0,f=a.length;c<f;c++){const d=a[c],e=new Date(d.getAttribute('data-posted-at'));if(!isNaN(e.valueOf())&&e.getFullYear()>1){const a=Math.abs(b.getTime()-e.getTime()),c=Math.ceil(a/(1e3*3600*24));c>=547&&(d.style.display='block',d.style.visibility='visible')}}})()</script>
</body>
</html>